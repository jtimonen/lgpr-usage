<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate an artificial longitudinal data set — simulate_data • lgpr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Generate an artificial longitudinal data set — simulate_data" />
<meta property="og:description" content="Generate an artificial longitudinal data set." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lgpr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/lgpr-package.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../tutorials/basic.html">Basic usage</a>
    </li>
    <li>
      <a href="../tutorials/heter.html">Heterogeneous effects</a>
    </li>
    <li>
      <a href="../tutorials/uncrt.html">Temporally uncertain effects</a>
    </li>
    <li>
      <a href="../tutorials/bb.html">Discrete observation model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/math.html">Mathematical description of lgpr models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/math.html">Mathematical description of lgpr models</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate an artificial longitudinal data set</h1>
    <small class="dont-index">Source: <a href='https://github.com/jtimonen/lgpr/blob/master/R/misc-simulate.R'><code>R/misc-simulate.R</code></a></small>
    <div class="hidden name"><code>simulate_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generate an artificial longitudinal data set.</p>
    </div>

    <pre class="usage"><span class='fu'>simulate_data</span><span class='op'>(</span>
  <span class='va'>N</span>,
  <span class='va'>t_data</span>,
  covariates <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>,
  names <span class='op'>=</span> <span class='cn'>NULL</span>,
  relevances <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>covariates</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
  n_categs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>covariates</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
  t_jitter <span class='op'>=</span> <span class='fl'>0</span>,
  lengthscales <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>12</span>, <span class='fl'>2</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>covariates</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
  f_var <span class='op'>=</span> <span class='fl'>1</span>,
  noise_type <span class='op'>=</span> <span class='st'>"gaussian"</span>,
  snr <span class='op'>=</span> <span class='fl'>3</span>,
  phi <span class='op'>=</span> <span class='fl'>1</span>,
  gamma <span class='op'>=</span> <span class='fl'>0.2</span>,
  N_affected <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>N</span><span class='op'>/</span><span class='fl'>2</span><span class='op'>)</span>,
  t_effect_range <span class='op'>=</span> <span class='st'>"auto"</span>,
  t_observed <span class='op'>=</span> <span class='st'>"after_0"</span>,
  c_hat <span class='op'>=</span> <span class='fl'>0</span>,
  dis_fun <span class='op'>=</span> <span class='st'>"gp_warp_vm"</span>,
  bin_kernel <span class='op'>=</span> <span class='cn'>FALSE</span>,
  steepness <span class='op'>=</span> <span class='fl'>0.5</span>,
  vm_params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>1</span><span class='op'>)</span>,
  continuous_info <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mu <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>pi</span><span class='op'>/</span><span class='fl'>8</span>, <span class='va'>pi</span>, <span class='op'>-</span><span class='fl'>0.5</span><span class='op'>)</span>, lambda <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>pi</span><span class='op'>/</span><span class='fl'>8</span>, <span class='va'>pi</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>,
  N_trials <span class='op'>=</span> <span class='fl'>1</span>,
  force_zeromean <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>N</th>
      <td><p>Number of individuals.</p></td>
    </tr>
    <tr>
      <th>t_data</th>
      <td><p>Measurement times (same for each individual, unless
<code>t_jitter &gt; 0</code> in which case they are perturbed).</p></td>
    </tr>
    <tr>
      <th>covariates</th>
      <td><p>Integer vector that defines the types of covariates
(other than id and age). If not given, only the id and age
covariates are created. Different integers correspond to the following
covariate types:</p><ul>
<li><p>0 = disease-related age</p></li>
<li><p>1 = other continuous covariate</p></li>
<li><p>2 = a categorical covariate that interacts with age</p></li>
<li><p>3 = a categorical covariate that acts as a group offset</p></li>
<li><p>4 = a categorical covariate that that acts as a group offset AND
  is restricted to have value 0 for controls and 1 for cases</p></li>
</ul></td>
    </tr>
    <tr>
      <th>names</th>
      <td><p>Covariate names.</p></td>
    </tr>
    <tr>
      <th>relevances</th>
      <td><p>Relative relevance of each component. Must have be a vector
so that <br />
 <code>length(relevances) =  2 + length(covariates)</code>. <br />
First two values define the relevance of the individual-specific age and
shared age component, respectively.</p></td>
    </tr>
    <tr>
      <th>n_categs</th>
      <td><p>An integer vector defining the number of categories
for each categorical covariate, so that <code><a href='https://rdrr.io/r/base/length.html'>length(n_categs)</a></code> equals to
the number of 2's and 3's in the <code>covariates</code> vector.</p></td>
    </tr>
    <tr>
      <th>t_jitter</th>
      <td><p>Standard deviation of the jitter added to the given
measurement times.</p></td>
    </tr>
    <tr>
      <th>lengthscales</th>
      <td><p>A vector so that <br /> <code>length(lengthscales) = </code>
<code>2 + sum(covariates %in% c(0,1,2))</code>.</p></td>
    </tr>
    <tr>
      <th>f_var</th>
      <td><p>variance of f</p></td>
    </tr>
    <tr>
      <th>noise_type</th>
      <td><p>Either "gaussian", "poisson", "nb" (negative binomial),
"binomial", or "bb" (beta-binomial).</p></td>
    </tr>
    <tr>
      <th>snr</th>
      <td><p>The desired signal-to-noise ratio. This argument is valid
only when <code>noise_type</code> is <code>"gaussian"</code>.</p></td>
    </tr>
    <tr>
      <th>phi</th>
      <td><p>The inverse overdispersion parameter for negative binomial data.
The variance is <code>g + g^2/phi</code>.</p></td>
    </tr>
    <tr>
      <th>gamma</th>
      <td><p>The dispersion parameter for beta-binomial data.</p></td>
    </tr>
    <tr>
      <th>N_affected</th>
      <td><p>Number of diseased individuals that are affected by the
disease. This defaults to the number of diseased individuals. This argument
can only be given if <code>covariates</code> contains a zero.</p></td>
    </tr>
    <tr>
      <th>t_effect_range</th>
      <td><p>Time interval from which the disease effect times are
sampled uniformly. Alternatively, This can any function that returns the
(possibly randomly generated) real disease effect time for one individual.</p></td>
    </tr>
    <tr>
      <th>t_observed</th>
      <td><p>Determines how the disease effect time is observed. This
can be any function that takes the real disease effect time as an argument
and returns the (possibly randomly generated) observed onset/initiation time.
Alternatively, this can be a string of the form <code>"after_n"</code> or
<code>"random_p"</code> or <code>"exact"</code>.</p></td>
    </tr>
    <tr>
      <th>c_hat</th>
      <td><p>a constant added to f</p></td>
    </tr>
    <tr>
      <th>dis_fun</th>
      <td><p>A function or a string that defines the disease effect. If
this is a function, that function is used to generate the effect.
If <code>dis_fun</code> is "gp_vm" or "gp_ns", the disease component is drawn from
a nonstationary GP prior ("vm" is the variance masked version of it).</p></td>
    </tr>
    <tr>
      <th>bin_kernel</th>
      <td><p>Should the binary kernel be used for categorical
covariates? If this is <code>TRUE</code>, the effect will exist only for group 1.</p></td>
    </tr>
    <tr>
      <th>steepness</th>
      <td><p>Steepness of the input warping function. This is only used
if the disease component is in the model.</p></td>
    </tr>
    <tr>
      <th>vm_params</th>
      <td><p>Parameters of the variance mask function. This is only
needed if <code>useMaskedVarianceKernel = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>continuous_info</th>
      <td><p>Info for generating continuous covariates. Must be a
list containing fields <code>lambda</code> and <code>mu</code>, which have length 3.
The continuous covariates are generated so that <code>x &lt;- sin(a*t + b) + c</code>,
where</p><ul>
<li><p><code>t &lt;- seq(0, 2*pi, length.out = k)</code></p></li>
<li><p><code>a &lt;- mu[1] + lambda[1]*stats::runif(1)</code></p></li>
<li><p><code>b &lt;- mu[2] + lambda[2]*stats::runif(1)</code></p></li>
<li><p><code>c &lt;- mu[3] + lambda[3]*stats::runif(1)</code></p></li>
</ul></td>
    </tr>
    <tr>
      <th>N_trials</th>
      <td><p>The number of trials parameter for binomial data.</p></td>
    </tr>
    <tr>
      <th>force_zeromean</th>
      <td><p>Should each component (excluding the disease age
component) be forced to have a zero mean?</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <a href='lgpsim-class.html'>lgpsim</a>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Generate Gaussian data</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>simulate_data</span><span class='op'>(</span>N <span class='op'>=</span> <span class='fl'>4</span>, t_data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>12</span>, <span class='fl'>24</span>, <span class='fl'>36</span>, <span class='fl'>48</span><span class='op'>)</span>, snr <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>

<span class='co'># Generate negative binomially (NB) distributed count data</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>simulate_data</span><span class='op'>(</span>
  N <span class='op'>=</span> <span class='fl'>6</span>, t_data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>10</span>, by <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>, noise_type <span class='op'>=</span> <span class='st'>"nb"</span>,
  phi <span class='op'>=</span> <span class='fl'>2</span>
<span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Juho Timonen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


